<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas-particles</title>
</head>

<body>
    <canvas id="canvas" width="300" height="300"></canvas>
</body>
<script>
    // 创建一个画布
    let cav = document.getElementById('canvas')

    let ctx = cav.getContext('2d')
    var winWidth = document.documentElement.clientWidth,
        winHeight = document.documentElement.clientHeight;
    cav.width = winWidth;
    cav.height = winHeight;
    let image = new Image()
    image.src = "img.jpeg"
    var dotList = []
    var imgW = image.width,
        imgH = image.height;
    image.onload = () => {
        ctx.drawImage(image, 0, 0)
        var imgData = ctx.getImageData(0, 0, imgW, imgH);
        for (let x = 0; x <= imgData.width; x += 6) {
            for (var y = 0; y < imgData.height; y += 6) {
                var i = (y * imgData.width + x) * 4;
                if (imgData.data[i + 3] > 128 && imgData.data[i] < 200) {
                    var dot = new Dot(x, y, 0, 2)
                    dotList.push(dot)
                }
            }
        }
        console.log(dotList, 'dotList');
        draw()
    }

    function Dot(x, y, z, r) {
        this.x = x
        this.y = y
        this.z = z
        this.r = r
    }

    function draw() {
        ctx.clearRect(0, 0, winWidth, winHeight);
        ctx.fillStyle = "#000";

        for (var i = 0; i < dotList.length; i += 1) {
            let curDot = dotList[i];
            ctx.save();
            ctx.beginPath();
            ctx.arc(curDot.x, curDot.y, curDot.r, 0, 2 * Math.PI);
            ctx.fillStyle = "pink"
            ctx.fill();
            ctx.restore();
        }
    }
</script>

</html>